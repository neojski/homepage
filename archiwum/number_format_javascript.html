<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="pl">
    <head>
    <title>Odpowiednik funkcji number_format (php) w języku javascript.</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <style type="text/css">
            code{white-space: pre; margin-left: 30px; }
            samp{border: 1px solid; display:block; margin-left:30px}
            samp span{white-space: pre;display:block}
            ins:before{content:'Update: '}
            ins{text-decoration:none}
    </style>
<script type="text/javascript">
/*
 * number_format 
 * http://creativecommons.org/licenses/LGPL/2.1/
 * no more thanks for Eluś http://forum.webhelp.pl/viewtopic.php?p=353165#353165 since his code has error: -0.04 format with 2 decimals
 */
 
// number, decimals, dec_point, thousand_sep
function number_format(n, q, r, s, p, i){
	return n.toFixed(q).replace(/(\d)(?=(\d{3})+)(\..+)?$/g,"$1"+(s||' ')+"$2").replace(/\./,r||',');
}
</script>
<script type="text/javascript">
onload=function(){
	var samp=document.getElementsByTagName('samp')[0];
	samp.removeChild(samp.firstChild)
	
	function test(n, q, r, s){
		var span=document.createElement('span');
		span.appendChild(document.createTextNode(number_format(n, q, r, s)+"\t"+' number_format('+n+','+q+','+r+','+','+s+')'));
		samp.appendChild(span);
	}
	
	var span=document.createElement('span');
	span.appendChild(document.createTextNode(number_format(1234567.8910, 2, ',', "'")+"\t"+' number_format(1234567.8910, 2, \',\', "\'") '));
	samp.appendChild(span);
	
	     
	var span=document.createElement('span');
	span.appendChild(document.createTextNode(number_format(34323.2323456,3,',','`')+"\t"+' number_format(34323.2323456,3,\',\',\'`\')'));
	samp.appendChild(span);
	var span=document.createElement('span');
	span.appendChild(document.createTextNode(number_format(34123323.234,-3,';','^')+"\t"+' number_format(34123323.234,-3,\';\',\'^\')'));
	samp.appendChild(span);
	
	var p = document.getElementById('code');
	var js = document.getElementsByTagName('script')[0].firstChild.nodeValue;
	
	p.removeChild(p.firstChild);
	
	var code = document.createElement('code');
	code.appendChild(document.createTextNode(js));
	
	p.appendChild(code);
}
</script>
  </head>

  <body>
  	<h1>Javascriptowy odpowiednik number_format (php)</h1>
    <p>Ze względu na brak pojawiające się błędy - kieruję na stronę projektu <a href="http://phpjs.org">phpjs</a>, gdzie jest funkcja <a href="http://phpjs.org/functions/number_format:481">number_format</a> na pewno znacznie dokładniej przetestowana.</p>
    <p>Ze względów naukowych pozostawiam jakąś pozostałość kodu, która <em>nie działa</em>.</p>
    
    <p id="code">Aby zobaczyć kod zernknij w źródło strony.</p>
    <p><ins datetime="20110905">Przekierowanie na stronę projektu phpjs.</ins></p>
    <p><ins datetime="20080629">Skrócenie kodu do wersji jednolinijkowej, wykorzystałem funkcję <a href="http://forum.webhelp.pl/viewtopic.php?p=353165#353165">fixed</a> napisaną przez Elusia.</ins></p>
    <p><ins datetime="20060722">Udało mi się skrócić kod i pozbyć się tablic.</ins></p>
    <p><ins datetime="20060812">Powrót do tablicowej wersji ze względu na błędy. Zamiana String(liczba) na (''+liczba) (oszczędność 3 znaków). Całkowita zgodność działania z <a href="http://pl2.php.net/number_format">odpowiednikiem php</a>.</ins></p>
    <p>I przykładowe działanie skryptu:</p>
    <samp>Skrypt jest oparty o skrypty javascript. Prawdopodobnie wyłączyłeś interpretacje kodu js w ustawieniach przeglądarki, więc nie mogę wyświetlić przykładu.</samp>
  </body>
</html>